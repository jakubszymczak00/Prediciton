#BAZA WIEDZY O MODELACH

MODELS_DB = {
    "IVECO": {
        "DAILY": [(2014, 2026, "VI"), (2011, 2014, "V"), (2006, 2011, "IV"), (2000, 2006, "III"), (1989, 2000, "II")]
    },
    "FIAT": {
        "DUCATO": [(2006, 2026, "III"), (1994, 2006, "II"), (1981, 1994, "I")],
        "DOBLO": [(2022, 2026, "III"), (2010, 2022, "II"), (2000, 2010, "I")],
        "SCUDO": [(2022, 2026, "III"), (2007, 2016, "II"), (1996, 2006, "I")],
        "FIORINO": [(2007, 2026, "III")],
        "TALENTO": [(2016, 2020, "I")]
    },
    "RENAULT": {
        "MASTER": [(2024, 2026, "IV"), (2010, 2024, "III"), (1998, 2010, "II")],
        "TRAFIC": [(2014, 2026, "III"), (2001, 2014, "II")],
        "KANGOO": [(2021, 2026, "III"), (2008, 2021, "II"), (1997, 2008, "I")],
        "CLIO": [(2019, 2026, "V"), (2012, 2019, "IV"), (2005, 2012, "III"), (1998, 2005, "II")],
        "MEGANE": [(2016, 2024, "IV"), (2008, 2016, "III"), (2002, 2008, "II"), (1995, 2002, "I")],
        "LAGUNA": [(2007, 2015, "III"), (2001, 2007, "II")],
        "TALISMAN": [(2015, 2022, "I")],
        "SCENIC": [(2016, 2023, "IV"), (2009, 2016, "III"), (2003, 2009, "II")],
        "ESPACE": [(2015, 2023, "V"), (2002, 2014, "IV")],
        "CAPTUR": [(2019, 2026, "II"), (2013, 2019, "I")],
        "KADJAR": [(2015, 2022, "I")]
    },
    "PEUGEOT": {
        "BOXER": [(2006, 2026, "III"), (1994, 2006, "II")],
        "PARTNER": [(2018, 2026, "III"), (2008, 2018, "II"), (1996, 2008, "I")],
        "EXPERT": [(2016, 2026, "III"), (2007, 2016, "II")],
        "TRAVELLER": [(2016, 2026, "I")],
        "RIFTER": [(2018, 2026, "I")],
        "208": [(2019, 2026, "II"), (2012, 2019, "I")],
        "308": [(2021, 2026, "III"), (2013, 2021, "II"), (2007, 2013, "I")],
        "508": [(2018, 2026, "II"), (2010, 2018, "I")],
        "2008": [(2019, 2026, "II"), (2013, 2019, "I")],
        "3008": [(2016, 2024, "II"), (2009, 2016, "I")],
        "5008": [(2017, 2026, "II"), (2009, 2017, "I")]
    },
    "CITROEN": {
        "JUMPER": [(2006, 2026, "III"), (1994, 2006, "II")],
        "BERLINGO": [(2018, 2026, "III"), (2008, 2018, "II"), (1996, 2008, "I")],
        "JUMPY": [(2016, 2026, "III"), (2007, 2016, "II")],
        "SPACETOURER": [(2016, 2026, "I")],
        "C3": [(2016, 2024, "III"), (2009, 2016, "II"), (2002, 2009, "I")],
        "C4": [(2020, 2026, "III"), (2010, 2018, "II"), (2004, 2010, "I")],
        "C5": [(2008, 2017, "III"), (2001, 2008, "II")]
    },
    "OPEL": {
        "MOVANO": [(2021, 2026, "C"), (2010, 2021, "B"), (1998, 2010, "A")],
        "VIVARO": [(2019, 2026, "C"), (2014, 2019, "B"), (2001, 2014, "A")],
        "COMBO": [(2018, 2026, "E"), (2011, 2018, "D"), (2001, 2011, "C")],
        "ASTRA": [(2021, 2026, "L"), (2015, 2021, "K"), (2009, 2015, "J"), (2004, 2014, "H"), (1998, 2009, "G")],
        "INSIGNIA": [(2017, 2022, "B"), (2008, 2017, "A")],
        "CORSA": [(2019, 2026, "F"), (2014, 2019, "E"), (2006, 2014, "D"), (2000, 2006, "C")],
        "ZAFIRA": [(2019, 2026, "Life"), (2011, 2019, "C"), (2005, 2011, "B"), (1999, 2005, "A")],
        "MOKKA": [(2020, 2026, "II"), (2012, 2019, "I")],
        "CROSSLAND": [(2017, 2026, "X")],
        "GRANDLAND": [(2017, 2026, "X")]
    },
    "FORD": {
        "TRANSIT": [(2014, 2026, "VIII"), (2006, 2014, "VII"), (2000, 2006, "VI")],
        "TRANSIT CUSTOM": [(2023, 2026, "II"), (2012, 2023, "I")],
        "TRANSIT CONNECT": [(2022, 2026, "III"), (2013, 2022, "II"), (2002, 2013, "I")],
        "TRANSIT COURIER": [(2023, 2026, "II"), (2014, 2023, "I")],
        "RANGER": [(2022, 2026, "Next-Gen"), (2011, 2022, "T6")],
        "FOCUS": [(2018, 2026, "Mk4"), (2010, 2018, "Mk3"), (2004, 2011, "Mk2"), (1998, 2004, "Mk1")],
        "MONDEO": [(2014, 2022, "Mk5"), (2007, 2014, "Mk4"), (2000, 2007, "Mk3")],
        "FIESTA": [(2017, 2023, "Mk8"), (2008, 2017, "Mk7"), (2002, 2008, "Mk6")],
        "KUGA": [(2019, 2026, "III"), (2012, 2019, "II"), (2008, 2013, "I")],
        "S-MAX": [(2015, 2023, "II"), (2006, 2014, "I")],
        "GALAXY": [(2015, 2023, "III"), (2006, 2015, "II")]
    },
    "VOLKSWAGEN": {
        "TRANSPORTER": [(2015, 2026, "T6"), (2003, 2015, "T5"), (1990, 2003, "T4")],
        "CRAFTER": [(2017, 2026, "II"), (2006, 2016, "I")],
        "CADDY": [(2020, 2026, "V"), (2015, 2020, "IV"), (2004, 2015, "III")],
        "AMAROK": [(2022, 2026, "II"), (2010, 2022, "I")],
        "LT": [(1996, 2006, "II")],
        "GOLF": [(2019, 2026, "VIII"), (2012, 2020, "VII"), (2008, 2013, "VI"), (2003, 2009, "V"), (1997, 2006, "IV"), (1991, 1999, "III")],
        "PASSAT": [(2023, 2026, "B9"), (2014, 2023, "B8"), (2010, 2014, "B7"), (2005, 2010, "B6"), (2000, 2005, "B5 FL"), (1996, 2000, "B5")],
        "POLO": [(2017, 2026, "VI"), (2009, 2017, "V"), (2001, 2009, "IV"), (1994, 2001, "III")],
        "TIGUAN": [(2023, 2026, "III"), (2016, 2023, "II"), (2007, 2016, "I")],
        "TOURAN": [(2015, 2026, "II"), (2003, 2015, "I")],
        "SHARAN": [(2010, 2022, "II"), (1995, 2010, "I")],
        "TOUAREG": [(2018, 2026, "III"), (2010, 2018, "II"), (2002, 2010, "I")],
        "ARTEON": [(2017, 2026, "I")],
        "T-ROC": [(2017, 2026, "I")],
        "ID.3": [(2019, 2026, "I")],
        "ID.4": [(2020, 2026, "I")]
    },
    "MERCEDES-BENZ": {
        "SPRINTER": [(2018, 2026, "III"), (2006, 2018, "II"), (1995, 2006, "I")],
        "VITO": [(2014, 2026, "III (W447)"), (2003, 2014, "II (W639)"), (1996, 2003, "I (W638)")],
        "CITAN": [(2021, 2026, "II"), (2012, 2021, "I")],
        "KLASA A": [(2018, 2026, "W177"), (2012, 2018, "W176"), (2004, 2012, "W169"), (1997, 2004, "W168")],
        "KLASA B": [(2018, 2026, "W247"), (2011, 2018, "W246"), (2005, 2011, "W245")],
        "KLASA C": [(2021, 2026, "W206"), (2014, 2021, "W205"), (2007, 2014, "W204"), (2000, 2007, "W203"), (1993, 2000, "W202")],
        "KLASA E": [(2023, 2026, "W214"), (2016, 2023, "W213"), (2009, 2016, "W212"), (2002, 2009, "W211"), (1995, 2002, "W210")],
        "KLASA S": [(2020, 2026, "W223"), (2013, 2020, "W222"), (2005, 2013, "W221"), (1998, 2005, "W220")],
        "CLA": [(2019, 2026, "II"), (2013, 2019, "I")],
        "CLS": [(2018, 2026, "III"), (2011, 2018, "II"), (2004, 2010, "I")],
        "GLA": [(2019, 2026, "H247"), (2013, 2019, "X156")],
        "GLB": [(2019, 2026, "X247")],
        "GLC": [(2022, 2026, "X254"), (2015, 2022, "X253")],
        "GLE": [(2018, 2026, "V167"), (2015, 2018, "W166")],
        "GLS": [(2019, 2026, "X167"), (2015, 2019, "X166")],
        "KLASA G": [(2018, 2026, "W463 II"), (1990, 2018, "W463")]
    },
    "TOYOTA": {
        "PROACE": [(2016, 2026, "II"), (2013, 2016, "I")],
        "PROACE CITY": [(2019, 2026, "I")],
        "PROACE MAX": [(2024, 2026, "I")],
        "HILUX": [(2015, 2026, "VIII"), (2005, 2015, "VII")],
        "DYNA": [(2000, 2020, "U300-400")],
        "COROLLA": [(2018, 2026, "XII"), (2013, 2018, "XI"), (2006, 2013, "X")],
        "YARIS": [(2020, 2026, "IV"), (2011, 2020, "III"), (2005, 2011, "II")],
        "RAV4": [(2019, 2026, "V"), (2013, 2018, "IV"), (2005, 2012, "III")],
        "AVENSIS": [(2009, 2018, "III"), (2003, 2009, "II")],
        "AURIS": [(2012, 2018, "II"), (2006, 2012, "I")],
        "C-HR": [(2023, 2026, "II"), (2016, 2023, "I")],
        "HIGHLANDER": [(2020, 2026, "IV")],
        "LAND CRUISER": [(2024, 2026, "250"), (2009, 2024, "150"), (2002, 2009, "120")],
        "PRIUS": [(2022, 2026, "V"), (2015, 2022, "IV"), (2009, 2015, "III")]
    },
    "BMW": {
        "SERIA 1": [(2019, 2026, "F40"), (2011, 2019, "F20"), (2004, 2011, "E87")],
        "SERIA 2": [(2021, 2026, "G42"), (2014, 2021, "F22")], 
        "SERIA 3": [(2018, 2026, "G20"), (2011, 2019, "F30"), (2005, 2013, "E90"), (1998, 2006, "E46"), (1990, 1999, "E36")],
        "SERIA 4": [(2020, 2026, "G22"), (2013, 2020, "F32")],
        "SERIA 5": [(2023, 2026, "G60"), (2017, 2023, "G30"), (2010, 2017, "F10"), (2003, 2010, "E60"), (1995, 2003, "E39")],
        "SERIA 6": [(2017, 2023, "G32"), (2011, 2018, "F13"), (2003, 2010, "E63")],
        "SERIA 7": [(2022, 2026, "G70"), (2015, 2022, "G11"), (2008, 2015, "F01"), (2001, 2008, "E65"), (1994, 2001, "E38")],
        "SERIA 8": [(2018, 2026, "G15"), (1989, 1999, "E31")],
        "X1": [(2022, 2026, "U11"), (2015, 2022, "F48"), (2009, 2015, "E84")],
        "X2": [(2023, 2026, "U10"), (2017, 2023, "F39")],
        "X3": [(2024, 2026, "G45"), (2017, 2024, "G01"), (2010, 2017, "F25"), (2003, 2010, "E83")],
        "X4": [(2018, 2026, "G02"), (2014, 2018, "F26")],
        "X5": [(2018, 2026, "G05"), (2013, 2018, "F15"), (2006, 2013, "E70"), (1999, 2006, "E53")],
        "X6": [(2019, 2026, "G06"), (2014, 2019, "F16"), (2008, 2014, "E71")],
        "X7": [(2018, 2026, "G07")],
        "Z4": [(2018, 2026, "G29"), (2009, 2016, "E89"), (2002, 2008, "E85")]
    },
    "AUDI": {
        "A1": [(2018, 2026, "GB"), (2010, 2018, "8X")],
        "A3": [(2020, 2026, "8Y"), (2012, 2020, "8V"), (2003, 2013, "8P"), (1996, 2003, "8L")],
        "A4": [(2015, 2026, "B9"), (2007, 2015, "B8"), (2004, 2008, "B7"), (2000, 2004, "B6"), (1994, 2001, "B5")],
        "A5": [(2016, 2026, "F5"), (2007, 2016, "8T")],
        "A6": [(2018, 2026, "C8"), (2011, 2018, "C7"), (2004, 2011, "C6"), (1997, 2004, "C5")],
        "A7": [(2018, 2026, "C8"), (2010, 2018, "C7")],
        "A8": [(2017, 2026, "D5"), (2009, 2017, "D4"), (2002, 2009, "D3"), (1994, 2002, "D2")],
        "Q2": [(2016, 2026, "I")],
        "Q3": [(2018, 2026, "F3"), (2011, 2018, "8U")],
        "Q5": [(2017, 2026, "FY"), (2008, 2017, "8R")],
        "Q7": [(2015, 2026, "II"), (2005, 2015, "I")],
        "Q8": [(2018, 2026, "I")],
        "TT": [(2014, 2023, "8S"), (2006, 2014, "8J"), (1998, 2006, "8N")]
    },
    "SKODA": {
        "OCTAVIA": [(2019, 2026, "IV"), (2012, 2020, "III"), (2004, 2013, "II"), (1996, 2010, "I")],
        "SUPERB": [(2023, 2026, "IV"), (2015, 2023, "III"), (2008, 2015, "II"), (2001, 2008, "I")],
        "FABIA": [(2021, 2026, "IV"), (2014, 2021, "III"), (2007, 2014, "II"), (1999, 2007, "I")],
        "KODIAQ": [(2023, 2026, "II"), (2016, 2023, "I")],
        "KAROQ": [(2017, 2026, "I")],
        "KAMIQ": [(2019, 2026, "I")],
        "SCALA": [(2019, 2026, "I")],
        "RAPID": [(2012, 2019, "I")]
    },
    "MAZDA": {
        "2": [(2014, 2026, "III"), (2007, 2014, "II")],
        "3": [(2019, 2026, "IV"), (2013, 2019, "III"), (2009, 2013, "II")],
        "6": [(2012, 2026, "III"), (2007, 2012, "II"), (2002, 2007, "I")],
        "CX-3": [(2015, 2022, "I")],
        "CX-5": [(2017, 2026, "II"), (2012, 2017, "I")],
        "CX-30": [(2019, 2026, "I")],
        "CX-60": [(2022, 2026, "I")]
    },
    "HONDA": {
        "CIVIC": [(2021, 2026, "XI"), (2017, 2021, "X"), (2011, 2017, "IX"), (2006, 2011, "VIII")],
        "ACCORD": [(2008, 2015, "VIII"), (2002, 2008, "VII")],
        "CR-V": [(2022, 2026, "VI"), (2016, 2022, "V"), (2011, 2016, "IV"), (2006, 2012, "III")],
        "HR-V": [(2021, 2026, "III"), (2015, 2021, "II")]
    },
    "NISSAN": {
        "MICRA": [(2017, 2026, "K14"), (2010, 2017, "K13"), (2002, 2010, "K12")],
        "QASHQAI": [(2021, 2026, "III"), (2013, 2021, "II"), (2007, 2013, "I")],
        "JUKE": [(2019, 2026, "II"), (2010, 2019, "I")],
        "X-TRAIL": [(2021, 2026, "IV"), (2013, 2021, "III"), (2007, 2013, "II")]
    },
    "KIA": {
        "RIO": [(2016, 2023, "IV"), (2011, 2017, "III")],
        "CEED": [(2018, 2026, "III"), (2012, 2018, "II"), (2006, 2012, "I")],
        "SPORTAGE": [(2021, 2026, "V"), (2015, 2021, "IV"), (2010, 2015, "III")],
        "SORENTO": [(2020, 2026, "IV"), (2014, 2020, "III")],
        "XCEED": [(2019, 2026, "I")]
    },
    "HYUNDAI": {
        "I20": [(2020, 2026, "III"), (2014, 2020, "II"), (2008, 2014, "I")],
        "I30": [(2016, 2026, "III"), (2011, 2017, "II"), (2007, 2012, "I")],
        "TUCSON": [(2020, 2026, "IV"), (2015, 2020, "III"), (2004, 2010, "I")],
        "SANTA FE": [(2023, 2026, "V"), (2018, 2023, "IV"), (2012, 2018, "III")]
    },
    "VOLVO": {
        "XC60": [(2017, 2026, "II"), (2008, 2017, "I")],
        "XC90": [(2014, 2026, "II"), (2002, 2014, "I")],
        "S60": [(2019, 2026, "III"), (2010, 2018, "II")],
        "V60": [(2018, 2026, "II"), (2010, 2018, "I")],
        "V40": [(2012, 2019, "II")]
    },
    "SEAT": {
        "IBIZA": [(2017, 2026, "V"), (2008, 2017, "IV"), (2002, 2008, "III")],
        "LEON": [(2020, 2026, "IV"), (2012, 2020, "III"), (2005, 2012, "II"), (1999, 2005, "I")],
        "ATECA": [(2016, 2026, "I")],
        "ARONA": [(2017, 2026, "I")]
    }
}

def get_generation_by_year(marka, model, rok):
    if not rok or not marka or not model:
        return None

    marka = marka.upper().strip()
    model = model.upper().strip()
    
    try:
        rok = int(rok)
    except:
        return None

    # Używamy globalnej bazy
    if marka in MODELS_DB:
        # Sortujemy modele od najdłuższego (np. PROACE CITY przed PROACE)
        sorted_models = sorted(MODELS_DB[marka].keys(), key=len, reverse=True)
        
        for model_key in sorted_models:
            if model_key in model:
                ranges = MODELS_DB[marka][model_key]
                for start, end, gen_name in ranges:
                    if start <= rok <= end:
                        return gen_name
    return None