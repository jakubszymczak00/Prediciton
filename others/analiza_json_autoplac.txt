(function() {
    console.clear();
    console.log("%c ğŸ•µï¸ OTOMOTO DEEP SCAN (Dostawcze) ", "background: #e30000; color: white; font-size: 16px; padding: 8px; font-weight: bold;");

    try {
        const raw = document.getElementById('__NEXT_DATA__').innerText;
        const json = JSON.parse(raw);
        const advert = json?.props?.pageProps?.advert;

        if (!advert) {
            console.error("âŒ Nie znaleziono danych oferty! (Czy to na pewno strona ogÅ‚oszenia?)");
            return;
        }

        // 1. GÅÃ“WNE ATRYBUTY
        console.group("1. GÅ‚Ã³wne Pola (Root)");
        console.log("TytuÅ‚:", advert.title);
        console.log("ID:", advert.id);
        console.log("Kategoria:", advert.category?.name);
        console.groupEnd();

        // 2. PARAMETRY (To nas najbardziej interesuje)
        console.group("2. Lista ParametrÃ³w (Klucz -> WartoÅ›Ä‡)");
        
        const params = advert.details || advert.parameters || [];
        const tableData = [];

        // Szukamy specyficznych kluczy
        let foundBody = false;
        let foundDrive = false;
        let foundGen = false;
        let foundVer = false;

        params.forEach(p => {
            tableData.push({
                "Klucz (key)": p.key,
                "Etykieta (label)": p.label,
                "WartoÅ›Ä‡ (value)": p.value,
                "Display Value": p.displayValue
            });

            if (p.key === 'body_type') foundBody = true;
            if (p.key === 'transmission' || p.key === 'drive') foundDrive = true;
            if (p.key === 'generation') foundGen = true;
            if (p.key === 'version') foundVer = true;
        });

        console.table(tableData);
        console.groupEnd();

        // 3. RAPORT BRAKÃ“W
        console.group("3. Raport BrakÃ³w");
        console.log(foundBody ? "âœ… Nadwozie (body_type): JEST" : "âŒ Nadwozie (body_type): BRAK w parametrach");
        console.log(foundDrive ? "âœ… NapÄ™d (drive/transmission): JEST" : "âŒ NapÄ™d: BRAK w parametrach");
        console.log(foundGen ? "âœ… Generacja: JEST" : "âš ï¸ Generacja: BRAK (Typowe dla dostawczych)");
        console.log(foundVer ? "âœ… Wersja: JEST" : "âš ï¸ Wersja: BRAK (Typowe dla dostawczych)");
        console.groupEnd();

        // 4. EKSPLORACJA HTML (JeÅ›li brak w JSON)
        console.group("4. Co widaÄ‡ wizualnie (HTML)?");
        const listItems = document.querySelectorAll('li');
        listItems.forEach(li => {
            const txt = li.innerText;
            if (txt.includes("Nadwozie") || txt.includes("NapÄ™d") || txt.includes("Generacja") || txt.includes("Wersja")) {
                console.log(`ğŸ‘ï¸ Widoczne na stronie: "${txt.replace(/\n/g, ': ')}"`);
            }
        });
        console.groupEnd();

    } catch (e) {
        console.error("BÅ‚Ä…d krytyczny skryptu:", e);
    }
})();